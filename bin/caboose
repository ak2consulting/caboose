#!/usr/bin/env coffee

sys = require 'sys'
caboose = require 'caboose'

usage = ->
  sys.puts [
    'usage: caboose'
    ''
    'commands:'
    '  start          Start server'
    '  test script    Test with script in test directory'
    '  run script     Run script'
    'options:'
    '  -h, --help     Show the help'
  ].join '\n'
  process.exit 1

error = (err) ->
  sys.puts "ERROR: #{err}"
  usage()

argv = require('optimist').argv
return usage() if argv.h or argv.help
return usage() if argv._.length is 0

command = argv._.shift()
return usage() unless caboose[command]?

caboose[command].call caboose, process.cwd(), argv